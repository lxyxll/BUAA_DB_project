{% extends 'adminlte_base.html' %}
{% block title %}处理投诉{% endblock %}

{% block content %}

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}
<div class="panel panel-default">
  <div class="panel-heading"><strong>处理投诉</strong></div>
  <div class="panel-body">
    <p><strong>投诉编号：</strong>#{{ complaint.complaint_id }}</p>
    <p><strong>订单编号：</strong>#{{ complaint.order_id }}</p>
    <p><strong>投诉人：</strong>{{ complaint.complainant_name }}</p>
    <p><strong>被投诉人：</strong>{{ complaint.accused_name }}</p>
    <p><strong>关联商品：</strong>{{ complaint.posting_title }}</p>
    <p><strong>当前状态：</strong>{{ complaint.status }}</p>

    <hr>

    <p><strong>投诉内容：</strong></p>
    <p>{{ complaint.content }}</p>

    {% if complaint.result %}
      <div class="alert alert-info" style="margin-top:15px;">
        <strong>历史处理结果：</strong><br>
        {{ complaint.result|linebreaksbr }}
      </div>
    {% endif %}

    <form method="post" style="margin-top:15px;">
      {% csrf_token %}

      <div class="form-group">
        <label>更新状态</label>
          <select name="status" class="form-control" required>
            <option value="处理中" {% if complaint.status == "处理中" %}selected{% endif %}>处理中</option>
            <option value="已处理" {% if complaint.status == "已处理" %}selected{% endif %}>已处理</option>
            <option value="驳回" {% if complaint.status == "驳回" %}selected{% endif %}>驳回</option>
          </select>
      </div>

      <div class="form-group">
        <label>处理结果</label>
        <textarea name="result" class="form-control" rows="5" required>{% if complaint.result %}{{ complaint.result }}{% endif %}</textarea>
      </div>

      <button type="submit" class="btn btn-success">提交处理结果</button>
      <a href="{% url 'market:admin_complaint_list' %}?status={{ complaint.status }}" class="btn btn-default">返回列表</a>
    </form>
  </div>

</div>
{% endblock %}
